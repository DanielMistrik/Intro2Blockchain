
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3.1. Chapter &#8212; An Introduction to the Blockchain</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.2. Summary" href="summary.html" />
    <link rel="prev" title="3. Networks" href="title.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">An Introduction to the Blockchain</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction to the Blockchain
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface/background.html">
   Background
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../baad/title.html">
   1. Blockchain as a Data Structure
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../baad/text.html">
     1.1. Chapter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baad/summary.html">
     1.2. Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baad/questions.html">
     1.3. Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baad/citations.html">
     1.4. Citations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../crypto/title.html">
   2. Cryptography
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../crypto/text.html">
     2.1. Chapter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crypto/summary.html">
     2.2. Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crypto/questions.html">
     2.3. Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crypto/citations.html">
     2.4. Citations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="title.html">
   3. Networks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3.1. Chapter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="summary.html">
     3.2. Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="questions.html">
     3.3. Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="citations.html">
     3.4. Citations
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Implementation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../bitcoin/title.html">
   4. Bitcoin
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../bitcoin/text.html">
     4.1. Chapter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bitcoin/summary.html">
     4.2. Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bitcoin/questions.html">
     4.3. Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bitcoin/citations.html">
     4.4. Citations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ethereum/title.html">
   5. Ethereum
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ethereum/text.html">
     5.1. Chapter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ethereum/summary.html">
     5.2. Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ethereum/questions.html">
     5.3. Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ethereum/citations.html">
     5.4. Citations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../vulnerabilities/title.html">
   6. Vulnerabilities
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../vulnerabilities/text.html">
     6.1. Chapter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../vulnerabilities/summary.html">
     6.2. Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../vulnerabilities/questions.html">
     6.3. Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../vulnerabilities/citations.html">
     6.4. Citations
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  On top of Blockchain
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../layer2/title.html">
   7. Layer 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../layer2/text.html">
     7.1. Chapter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../layer2/summary.html">
     7.2. Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../layer2/questions.html">
     7.3. Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../layer2/citations.html">
     7.4. Citations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../DeFi/title.html">
   8. DeFi
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../DeFi/text.html">
     8.1. Chapter
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/networks/text.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/DanielMistrik/Intro2Blockchain"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/DanielMistrik/Intro2Blockchain/issues/new?title=Issue%20on%20page%20%2Fchapters/networks/text.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nodes">
   3.1.1. Nodes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#node-gossip">
     3.1.1.1. Node Gossip
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#node-on-boarding">
     3.1.1.2. Node On-boarding
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#consensus">
   3.1.2. Consensus
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pow">
     3.1.2.1. PoW
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pos">
     3.1.2.2. PoS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pow-v-pos">
     3.1.2.3. PoW v PoS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#maintaining-the-network">
   3.1.3. Maintaining the Network
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forking">
     3.1.3.1. Forking
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#accidental-forking">
       3.1.3.1.1. Accidental Forking
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#intentional-fork">
       3.1.3.1.2. Intentional Fork
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#miners">
     3.1.3.2. Miners
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-blockchain">
   3.1.4. Types of Blockchain
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#byzantium">
   3.1.5. Byzantium
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="chapter">
<h1><span class="section-number">3.1. </span>Chapter<a class="headerlink" href="#chapter" title="Permalink to this headline">¶</a></h1>
<p>In the first chapter we described blockchain as a network which maintains
the blockchain data structure. In this chapter we will explore this network
and understand how its participants coordinate to keep the blockchain
data structure valid.</p>
<p>As a refresher the network is composed of potentially millions of
computers, called <em>nodes</em>. <em>Nodes</em> are responsible for storing, adding to
and verified the blockchain data structure and as we will see they
come in many flavours. <em>Nodes</em> are often connected to each other in
a random combination forming a web of connections that is the distributed
system of blockchain. This web is responsible for transporting any and
all information on/about the blockchain.</p>
<div class="section" id="nodes">
<h2><span class="section-number">3.1.1. </span>Nodes<a class="headerlink" href="#nodes" title="Permalink to this headline">¶</a></h2>
<p>Nodes are the basic building block of networks. Nodes are devices that
connect with other devices to share data the network cares about, in our
case <em>BADS</em>. This is a vague definition and that is because there are
different types of nodes:</p>
<ul class="simple">
<li><p><strong>‘Full’ Nodes</strong> - Nodes that store the entire blockchain and can
verify all data independently and produce blocks. When we just say ‘nodes’
we typically mean full nodes.</p></li>
<li><p><strong>‘Light’ Nodes</strong> - Nodes that only store the block headers and need
the help of full nodes to verify data. Typically, don’t produce
blocks. When we talk about light nodes we will explicitly mention they
are light nodes.</p></li>
</ul>
<p><strong>‘Light’ Nodes</strong> are a solution to the fact that some network participants
can’t store the whole blockchain. The benefit of light nodes is that
they can still verify incoming data, a useful feature for nodes
that want to host wallets in currency blockchains like Bitcoin. They do
this as follows:</p>
<ol class="simple">
<li><p>They send a connected full node the hash of the data they want to verify</p></li>
<li><p>The full node locates the block the data is in and sends a <em>merkle path</em> to the light node</p></li>
<li><p>The light node uses the merkle path to construct a merkle root and if
it matches the root in its block header the data is valid as it is in the
blockchain.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>Merkle Paths</em> are an efficient solution to proving whether a piece
of data is in a merkle tree. Rather than use all the data and
let the light node construct the merkle root from scratch we only need the hashes
of the nodes that come into contact with the <em>path</em> from the root
to the piece of data we want. This means that we only need to send
a couple of hashes rather than the whole merkle tree. This helps efficiency.</p>
<p><img alt="Exp" src="../../_images/merkle_path.png" />
<em>If we want to verify that 4 is in our merkle tree we don’t need the
whole merkle tree to do it. Assuming we know what the root is
supposed to be we only need the hashes highlighted in blue and we can
calculate the rest, shown in red.</em></p>
</div>
<div class="section" id="node-gossip">
<h3><span class="section-number">3.1.1.1. </span>Node Gossip<a class="headerlink" href="#node-gossip" title="Permalink to this headline">¶</a></h3>
<p>In a distributed system and network like Bitcoin there is no authority
to manage connections so nodes have to manage them on their own. Node
communication is often analogized to <em>gossiping</em>.</p>
<p>Nodes often store a ‘contact list’ of connected nodes and they often
‘ping’ their contacts to check if they are new. If a new node arrives
nodes share their contact lists so the node can quickly connect with
others. Nodes typically have multiple connections, between 4-5, to make
sure any connected node going offline or turning out to be malicious doesn’t severely
impact the node.</p>
<p>Nodes therefore form a disorganized connection network where they <em>gossip</em>
information about the blockchain. Nodes can come and leave as they wish
without affecting the network at-large. This greatly adds to the stability of
the network.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Nodes leaving and going as they please is one of the benefits of
distributed networks vs centralized ones. If the ‘leader’ node leaves
in a centralized network that network stops functioning.</p>
</div>
<p>The gossip network is also optimized against malicious data. Nodes
don’t blindly relay data they receive as that could clog up the network
with useless or malicious data. Every time a node receives a piece of
data or block it verifies it. If the data/block is valid and is new, the node
hasn’t seen it, the node stores it and sends it to the nodes in its
connection list. If the data/block is invalid the node discards it, sends
it to no one, and potentially removes the node who sent it that data
from its contact list.</p>
<p>Information propagates through the network from node
to node and because one node sends it to multiple nodes the spread is
<em>exponential</em>. This means that data, if valid, propagates through the entire
disorganized network in a matter of seconds while invalid data is stopped
at the first nodes that receive it. The origin of data is not shared
so when a node receives data/block it doesn’t know where it originally
came from.</p>
<p>Nodes technically have no responsibility to do anything, propagate data or
generate blocks. Many nodes don’t generate blocks. Full nodes that do, store
data that is valid but not in a block yet in a special area called a
<em>mem pool</em>, in the case of Bitcoin. When nodes create new blocks the data they
contain comes from the <em>mem pool</em>. If a node receives or generates a valid block the data it
contains is removed from its <em>mem pool</em>.</p>
</div>
<div class="section" id="node-on-boarding">
<h3><span class="section-number">3.1.1.2. </span>Node On-boarding<a class="headerlink" href="#node-on-boarding" title="Permalink to this headline">¶</a></h3>
<p>We mentioned that nodes can come and leave as they please. This means
nodes go out of sync with the rest of the network and their blockchain
is incomplete, or non-existent when it’s a completely new nodes. A
node that is completely new to the network does the following:</p>
<ol class="simple">
<li><p>You start with the most recent trusted block, the newest block you
trust to be valid. For new nodes this block is the genesis block that
is hard-coded in the blockchain implementation.</p></li>
<li><p>Reach out to other nodes in the network, as you connect with nodes
you receive their contact lists and reach out to even more nodes.</p></li>
<li><p>You ask your connections for all the blockchain data &amp; blocks they have.</p></li>
<li><p>You verify the data/block and if it references your most recent trusted
block you add to your own blockchain. If it doesn’t reference that block but
is otherwise valid you keep hold on to it, it’s possible that you received
a valid block before you got some of its predecessors.</p></li>
<li><p>Repeat step 3 &amp; 4 until your most recent trusted block is also the
blockchains most recent block, this can take a couple of days.</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We occasionally use the word <em>hard-coded</em>. This means that this piece of
data is a part of the implementation and anyone who has the implementation
automatically has the data.</p>
</div>
<p>For a light node the process is simpler and faster as you only receive the
block headers which can be quickly verified, do they reference the most
recent trusted block header and do they meet the blockchain’s block
validation guidelines.</p>
</div>
</div>
<div class="section" id="consensus">
<h2><span class="section-number">3.1.2. </span>Consensus<a class="headerlink" href="#consensus" title="Permalink to this headline">¶</a></h2>
<p>Formally <em>consensus</em> is when a network reaches the same conclusion.
For the blockchain the same conclusion means the same <em>BADS</em>. Consensus
guarantees Blockchain’s ‘identicalness-as-a-requirement’. Consensus
is a fascinating subject because it is a process that happens independently
at every node but the result is always the same.</p>
<p>Consensus determines what a valid block is and guarantees that it is
added to every node’s blockchain.</p>
<p>Consensus can be achieved through
a number of <em>consensus algorithms</em>. We will be looking at the two of the
more famous algorithms: <em>Proof-of-Work</em> and <em>Proof-of-Stake</em>.</p>
<div class="section" id="pow">
<h3><span class="section-number">3.1.2.1. </span>PoW<a class="headerlink" href="#pow" title="Permalink to this headline">¶</a></h3>
<p>Proof-of-Work (<em>PoW</em>) is a consensus algorithm that depends on hashing. Its primary
component is
the <em>hash puzzle</em> which is composed of a <em>target</em> value that the block header’s hash
has to be smaller than the for the block to be valid. Getting such the desired block header hash is done
by altering the <em>nonce</em>, a field in the block header, and is intentionally
difficult to solve. A value called the <em>difficulty</em> determines how low the target is,
difficulty and the target value are inversely correlated so a higher
difficulty means a lower target. To keep the <em>ABCT</em> (Average Block
Creation Time) constant the difficulty is regularly updated.</p>
<p><em>PoW</em> is a competition between nodes for who solves the hash puzzle,
gets a block header whose value is smaller than the target. Blockchains
typically reward the node that wins this competition. This means nodes are
incentivized to try to solve the hash puzzle and when someone claims
victory, to critically analyze their winning block, as no node
wants to lose a potential reward to a cheat.</p>
<p>To win <em>PoW</em> nodes can only do one-thing, guess. There is no clever
way to solve the hash puzzle, nodes just have to guess a million numbers
and check if any of them get the desired block header. This means millions
upon millions of calculations, most of which will go to waste. This is
incredibly inefficient and PoW has been criticized for being so wasteful.</p>
<p><em>PoW</em> also shifts the definition of an <em>honest majority</em> in a blockchain.
In this consensus algorithm an honest majority is an honest majority of
computing power. This <em>one-cpu one vote</em> ideology has the shortcomings
that it benefits richer miners with better equipment.</p>
<p>Difficulty is also used to determine what chain is the valid one. In
<em>PoW</em> we might have malicious actors trying to push their fraudulent
chain of the blockchain to be the valid one. To prevent this, <em>PoW</em>
defines the <em>valid</em> chain as the one with the most cumulative difficulty.
The reasoning is that if we have an honest majority of computing power
then it will be able to produce the most blocks with the greatest difficulty
and therefore always be ahead of any attackers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When we talk about chains we talk about a sequence of blocks pointing
to each other. These chains might share some nodes, all share the
genesis block, but disagree on others. In <em>PoW</em> we might have
multiple competing chains at the same time due to <em>forking</em>, which we
will cover shortly, or because of malicous actors trying to push a
fraudulent blocks.</p>
</div>
</div>
<div class="section" id="pos">
<h3><span class="section-number">3.1.2.2. </span>PoS<a class="headerlink" href="#pos" title="Permalink to this headline">¶</a></h3>
<p>Proof-of-Stake (<em>PoS</em>) is a consensus mechanism where nodes can only propose
and validate blocks if they <em>stake</em> the blockchains native token, if it has
one. By <em>staking</em> we mean that the node stores the blockchains token
for a given period of time without moving it. These tokens are <em>staked</em>
to act as collateral against malicious behaviour, if a node produces
a block with invalid data or validates a block like that is loses some
of its tokens, this is known as <em>slashing</em>. Nodes can have two roles
in a PoS system: producers (responsible for actually producing the block) or
validators (responsible for checking the block is valid).</p>
<p><em>PoS</em> is alot more diverse in its implementations than <em>PoW</em>. In some
implementations, like <a class="reference external" href="https://www.peercoin.net/whitepapers/peercoin-paper.pdf">PeerCoin</a>,
nodes become eligible to produce blocks as soon as they stake their
currency for a period of time, for PeerCoin 30 days, while others,
like Ethereum 2.0, it is a more organized process.</p>
<p>In Ethereum 2.0 the process is more structured and nodes need to stake
at least a set number of tokens, in Ethereum 32 Ether, to be considered
to produce the next block. The actual producer of the block is chosen
<em>pseudo-randomly</em> by the blocks and while the other staked nodes
become validators and are put into committees. Before a block is
validated it needs to pass a number of these committees and any malicious
behaviour, either on the side of the validator or producer, is strictly
punished.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The last paragraph might be a bit confusing. Pseudo-random: didn’t we say
that bad? Yes and no. It’s bad when used for cryptography but here we
are only deciding which node gets to produce the next block. We are also
doing so based on data about the blockchain that is produced unpredictably,
so pseudo-random is fine here. This might seem like a very unsatisfying answer
and that is because the actual process of producing the same pseudo-random
number at every node independently is an incredibly difficult thing to
do. On Ethereum it is done by something called the <em>Beacon Chain</em> and
<em>RANDAO</em>, both programs, which also decide which nodes
are the producer and validator. Discussion of these two
in any sort of depth is far beyond the scope of this textbook.</p>
</div>
<p><em>PoS</em> defines an honest majority as a majority of the staked tokens.
The rationale behind this is that even when a malicous party
has a majority of the staked tokens they wouldn’t want to undermine
the blockchain they are so heavily invested with. Valid chains
are determined either still by difficulty, through a simplified hash
puzzle that has to be solved on top of PoS, or determined by programs
like the <em>Beacon Chain</em> in Ethereum 2.0 . But in general, the number
of chains in PoS is greatly reduced so determining the valid chain
is alot less complicated, and we pay it less mind.</p>
<p><em>PoS</em> blockchains still reward producers and some, like Ethereum 2.0,
also reward validators. This makes them a more reliable source of
tokens than PoW that is just a winner-take-all competition.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This reliability is the primary driver of the popularity of staking. Where
cryptocurrency holders stake their tokens in reward for interest.</p>
</div>
<p>The benefits of <em>PoS</em> is that blocks are produced relatively
easily, you just collect a set of valid data and produce a block around it.
This means there is far less processing waste than with <em>PoW</em> as there
is no hash puzzle to solve, or it’s very simple to solve like in the case
of PeerCoin.</p>
</div>
<div class="section" id="pow-v-pos">
<h3><span class="section-number">3.1.2.3. </span>PoW v PoS<a class="headerlink" href="#pow-v-pos" title="Permalink to this headline">¶</a></h3>
<p>Proof-of-Work was the first consensus algorithm used on the blockchain
through Bitcoin while Proof-of-Stake started showing up a couple years
later. In many ways <em>PoS</em> was created to address the shortcoming of
<em>PoW</em> but both consensus algorithms have their pros and cons.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm</p></th>
<th class="head"><p>Pros</p></th>
<th class="head"><p>Cons</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PoW</p></td>
<td><p>Is battle-tested and more reliable than PoS</p></td>
<td><p>Very inefficient by design</p></td>
</tr>
<tr class="row-odd"><td><p>PoS</p></td>
<td><p>More efficient and doesn’t benefit better equipped miners</p></td>
<td><p>Higher cost of entry than PoW, you have to stake tokens to participate</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The benefit of <em>PoW</em> might seem strange. Why would we care that
<em>PoW</em> has more real-world experience when it is less efficient? The
answer is that for some projects, like rockets, reliability
is far more important than efficiency. This is the reason why
the latest <a class="reference external" href="https://www.zdnet.com/article/from-earth-to-orbit-with-linux-and-spacex/">rockets use processor older than anything you could
currently buy</a>.</p>
</div>
</div>
</div>
<div class="section" id="maintaining-the-network">
<h2><span class="section-number">3.1.3. </span>Maintaining the Network<a class="headerlink" href="#maintaining-the-network" title="Permalink to this headline">¶</a></h2>
<p>We have covered how a blockchain network ought to run to maintain
<em>BADS</em> but we still need to figure out how to <em>maintain</em> it. We need
to address how are accidents/mistakes solved and who actually partakes
in block production/validation.</p>
<div class="section" id="forking">
<h3><span class="section-number">3.1.3.1. </span>Forking<a class="headerlink" href="#forking" title="Permalink to this headline">¶</a></h3>
<div class="section" id="accidental-forking">
<h4><span class="section-number">3.1.3.1.1. </span>Accidental Forking<a class="headerlink" href="#accidental-forking" title="Permalink to this headline">¶</a></h4>
<a class="reference internal image-reference" href="../../_images/fork.png"><img alt="Fork" class="align-right" src="../../_images/fork.png" style="height: 250px;" /></a>
<p>We called <em>PoW</em> a competition, but what happens when we get a tie?
When two nodes produce two valid blocks at the same time and propagate
it through the network we will have a split. Some nodes
will have a different blockchain from the rest following the very
consensus algorithm that was supposed to prevent this. What do we do?</p>
<p>First we must mention that accidental forking is rare, this does not
happen every time a block is produced, so we are dealing with an
infrequent situation. When this happens the blockchain has two
valid chains, as the difficulty should be the same. This is called <em>forking</em>.
Nodes can and do detect it and store both chains but work on a block
that only goes on top of one of them, as linked-list nodes can only point
to one other node. This means that when the next block is produced it will
only reference one chain and then the cumulative difficulty definition of
a <em>PoW</em> chain kicks in. The chain that the new block references becomes the
valid chain and the other is discarded.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is theoretically possible that two blocks are produced at the same time
when there is already a fork. This is very unlikely and even if it happens
we just wait until only one block is produced and then apply the above.</p>
</div>
</div>
<div class="section" id="intentional-fork">
<h4><span class="section-number">3.1.3.1.2. </span>Intentional Fork<a class="headerlink" href="#intentional-fork" title="Permalink to this headline">¶</a></h4>
<p>The above happens accidentally. We don’t want two chains, but it happens
by chance, and we can’t predict. This happens when the blockchain implementation
changes rules and nodes are divided by whether they follow the new ones or not.
There are two types:</p>
<ul class="simple">
<li><p><strong>Soft Fork</strong> - The rule changes are such that even nodes that
don’t follow them can add valid blocks under the new rules (i.e.
increases the block size).</p></li>
<li><p><strong>Hard Fork</strong> - The rule changes are such that nodes that
don’t follow them cannot add valid blocks under the new rules (i.e.
change data validation).</p></li>
</ul>
<p>While both can produce two chains (forks) the latter is far more likely to do so
and two chains can continue to exist for a very long-time, this is in
contrast to accidental forks where two chains exist only temporarily.
Forks can cause the creation of new blockchain projects (Bitcoin and Bitcoin
Cash).</p>
</div>
</div>
<div class="section" id="miners">
<h3><span class="section-number">3.1.3.2. </span>Miners<a class="headerlink" href="#miners" title="Permalink to this headline">¶</a></h3>
<p>Consensus is therefore critical
to the survival of any blockchain but because nodes aren’t <em>forced</em> to
create or validate blocks we need some sort of incentive.</p>
</div>
</div>
<div class="section" id="types-of-blockchain">
<h2><span class="section-number">3.1.4. </span>Types of Blockchain<a class="headerlink" href="#types-of-blockchain" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="byzantium">
<h2><span class="section-number">3.1.5. </span>Byzantium<a class="headerlink" href="#byzantium" title="Permalink to this headline">¶</a></h2>
<p>{The big finish, go over the whole problem explain what we learned
in the first two chapters and explain the last puzzle piece and then
explain the whole thing}</p>
<p>This chapter concludes the basics. If you only wanted to
know the basic building blocks of a blockchain congratulations, you now
know them. The next part of the textbook will take what we learned and
apply them to actual blockchain implementations. Up to now we were
largely in the idealistic theoretical realm but as you will see in the coming
chapters’ implementation is not always clean.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters\networks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="title.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">3. </span>Networks</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="summary.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.2. </span>Summary</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Cornell Blockchain<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>